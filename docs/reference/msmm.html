<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Function providing several methods to estimate the multiplicative
structural mean model (MSMM) of Robins (1989)."><title>Multiplicative structural mean model — msmm • OneSampleMR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multiplicative structural mean model — msmm"><meta property="og:description" content="Function providing several methods to estimate the multiplicative
structural mean model (MSMM) of Robins (1989)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">OneSampleMR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/compare-smm-fits.html">Comparison fits of the multiplicative structural mean model</a>
    <a class="dropdown-item" href="../articles/f-statistic-comparison.html">Comparison of conditional F-statistics</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/remlapmot/OneSampleMR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Multiplicative structural mean model</h1>
      <small class="dont-index">Source: <a href="https://github.com/remlapmot/OneSampleMR/blob/HEAD/R/msmm.R" class="external-link"><code>R/msmm.R</code></a></small>
      <div class="d-none name"><code>msmm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function providing several methods to estimate the multiplicative
structural mean model (MSMM) of Robins (1989).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">msmm</span><span class="op">(</span>
  <span class="va">formula</span>,
  <span class="va">instruments</span>,
  <span class="va">data</span>,
  <span class="va">subset</span>,
  <span class="va">na.action</span>,
  contrasts <span class="op">=</span> <span class="cn">NULL</span>,
  estmethod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gmm"</span>, <span class="st">"gmmalt"</span>, <span class="st">"tsls"</span>, <span class="st">"tslsalt"</span><span class="op">)</span>,
  t0 <span class="op">=</span> <span class="cn">NULL</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula, instruments</dt>
<dd><p>formula specification(s) of the regression
relationship and the instruments. Either <code>instruments</code> is missing and
<code>formula</code> has three parts as in <code>y ~ x1 + x2 | z1 + z2 + z3</code>
(recommended) or <code>formula</code> is <code>y ~ x1 + x2</code> and <code>instruments</code>
is a one-sided formula <code>~ z1 + z2 + z3</code> (only for backward
compatibility).</p></dd>
<dt>data</dt>
<dd><p>an optional data frame containing the variables in the model.
By default the variables are taken from the environment of the
<code>formula</code>.</p></dd>
<dt>subset</dt>
<dd><p>an optional vector specifying a subset of observations to be
used in fitting the model.</p></dd>
<dt>na.action</dt>
<dd><p>a function that indicates what should happen when the data
contain <code>NA</code>s. The default is set by the <code>na.action</code> option.</p></dd>
<dt>contrasts</dt>
<dd><p>an optional list. See the <code>contrasts.arg</code> of
<code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix.default</a></code>.</p></dd>
<dt>estmethod</dt>
<dd><p>Estimation method, please use one of</p><ul><li><p><code>"gmm"</code> GMM estimation of the MSMM (the default).</p></li>
<li><p><code>"gmmalt"</code> GMM estimation of the alternative moment conditions
for the MSMM as per Clarke et al. (2015). These are the same moment
conditions fit by the user-written Stata command <code>ivpois</code> (Nichols, 2007)
and by the official Stata command <code>ivpoisson gmm ..., multiplicative</code>
(StataCorp., 2013).</p></li>
<li><p><code>"tsls"</code> the TSLS method of fitting the MSMM of Clarke et al. (2015).
For binary \(Y\) and \(X\) this uses \(Y*(1-X)\) as the outcome and
\(Y*X\) as the exposure.</p></li>
<li><p><code>"tslsalt"</code> the alternative TSLS method of fitting the MSMM of
Clarke et al. (2015). For binary \(Y\) and \(X\) this uses \(Y*X\)
as the outcome and \(Y*(1-X)\) as the exposure.</p></li>
</ul></dd>
<dt>t0</dt>
<dd><p>A vector of starting values for the gmm optimizer. This should
have length equal to the number of exposures plus 1.</p></dd>
<dt>...</dt>
<dd><p>further arguments passed to or from other methods.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>"msmm"</code>. A list with the following items:</p>
<dl><dt>fit</dt>
<dd><p>The object from either a <code><a href="https://rdrr.io/pkg/gmm/man/gmm.html" class="external-link">gmm::gmm()</a></code> or <code><a href="https://john-d-fox.github.io/ivreg//reference/ivreg.html" class="external-link">ivreg::ivreg()</a></code> fit.</p></dd>
<dt>crrci</dt>
<dd><p>The causal risk ratio/s and it corresponding 95% confidence
interval limits.</p></dd>
<dt>estmethod</dt>
<dd><p>The specified <code>estmethod</code>.</p></dd>
</dl><p>If <code>estmethod</code> is <code>"tsls"</code>, <code>"gmm"</code>, or <code>"gmmalt"</code>:</p>
<dl><dt>ey0ci</dt>
<dd><p>The estimate of the treatment/exposure free potential outcome and
its 95% confidence interval limits.</p></dd>
</dl><p>If <code>estmethod</code> is <code>"tsls"</code> or <code>"tslsalt"</code>:</p>
<dl><dt>stage1</dt>
<dd><p>An object containing the first stage regression from an
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">stats::lm()</a></code> fit.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Function providing several methods to estimate the multiplicative
structural mean model (MSMM) of Robins (1989). These are the methods
described in Clarke et al. (2015), most notably
generalised method of moments (GMM) estimation of the MSMM.</p>
<p>An equivalent estimator to the MSMM was proposed in Econometrics by Mullahy (1997) and
then discussed in several articles by Windmeijer (1997, 2002) and Cameron
and Trivedi (2013). This was implemented in the user-written Stata command <code>ivpois</code>
(Nichols, 2007) and then implemented in official Stata in the <code>ivpoisson</code>
command (StataCorp., 2013).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Cameron AC, Trivedi PK. Regression analysis of count data. 2nd ed. 2013.
New York, Cambridge University Press. ISBN:1107667275</p>
<p>Clarke PS, Palmer TM, Windmeijer F. Estimating structural
mean models with multiple instrumental variables using the
Generalised Method of Moments. Statistical Science, 2015, 30, 1,
96-117. <a href="https://doi.org/10.1214/14-STS503" class="external-link">doi:10.1214/14-STS503</a></p>
<p>Hernán and Robins. Instruments for causal inference: An
Epidemiologist's dream? Epidemiology, 2006, 17, 360-372.
<a href="https://doi.org/10.1097/01.ede.0000222409.00878.37" class="external-link">doi:10.1097/01.ede.0000222409.00878.37</a></p>
<p>Mullahy J. Instrumental-variable estimation of count data models:
applications to models of cigarette smoking and behavior. The Review of
Economics and Statistics. 1997, 79, 4, 586-593.
<a href="https://doi.org/10.1162/003465397557169" class="external-link">doi:10.1162/003465397557169</a></p>
<p>Nichols A. ivpois: Stata module for IV/GMM Poisson regression. 2007.
<a href="https://ideas.repec.org/c/boc/bocode/s456890.html" class="external-link">url</a></p>
<p>Palmer TM, Sterne JAC, Harbord RM, Lawlor DA, Sheehan NA, Meng S,
Granell R, Davey Smith G, Didelez V.
Instrumental variable estimation of causal risk ratios and causal odds ratios
in Mendelian randomization analyses.
American Journal of Epidemiology, 2011, 173, 12, 1392-1403.
<a href="https://doi.org/10.1093/aje/kwr026" class="external-link">doi:10.1093/aje/kwr026</a></p>
<p>Robins JM. The analysis of randomised and
nonrandomised AIDS treatment trials using a new approach to
causal inference in longitudinal studies.
In Health Service Research Methodology: A Focus on AIDS
(L. Sechrest, H. Freeman and A. Mulley, eds.). 1989. 113–159.
US Public Health Service, National Center for Health Services Research,
Washington, DC.</p>
<p>StataCorp. Stata Base Reference Manual. Release 13.
ivpoisson - Poisson model with continuous endogenous covariates. 2013.
<a href="https://www.stata.com/manuals13/rivpoisson.pdf" class="external-link">url</a></p>
<p>Windmeijer FAG, Santos Silva JMC. Endogeneity in Count Data Models:
An Application to Demand for Health Care. Journal of Applied Econometrics.
1997, 12, 3, 281-294.
<a href="https://doi.org/10/fdkh4n" class="external-link">doi:10/fdkh4n</a></p>
<p>Windmeijer, F. ExpEnd, A Gauss programme for non-linear GMM estimation of
EXPonential models with ENDogenous regressors for cross section and panel
data. CEMMAP working paper CWP14/02. 2002.
<a href="https://www.cemmap.ac.uk/wp-content/uploads/2020/08/CWP1402.pdf" class="external-link">url</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># Single instrument example</span></span>
<span class="r-in"><span class="co"># Data generation from the example in the ivtools ivglm() helpfile</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span></span>
<span class="r-in"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span class="r-in"><span class="va">psi0</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span class="r-in"><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span class="r-in"><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.7</span><span class="op">*</span><span class="va">Z</span> <span class="op">+</span> <span class="fl">0.2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">Z</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">0.8</span><span class="op">*</span><span class="va">X</span> <span class="op">-</span> <span class="fl">0.39</span><span class="op">*</span><span class="va">Z</span><span class="op">)</span></span>
<span class="r-in"><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">psi0</span><span class="op">*</span><span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">m0</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">m0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">Z</span>, <span class="va">X</span>, <span class="va">Y</span><span class="op">)</span></span>
<span class="r-in"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">msmm</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">|</span> <span class="va">Z</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation method: gmm </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GMM fit summary:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gmm::gmm(g = msmmMoments, x = dat, t0 = t0, vcov = "iid")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Method:  twoStep </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Estimate     Std. Error   t value      Pr(&gt;|t|)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Theta[1]   7.2784e-01   2.5893e-02   2.8110e+01  7.4591e-174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Theta[2]   1.3107e-01   6.0307e-02   2.1733e+00   2.9754e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> J-Test: degrees of freedom is 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 J-test                P-value             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test E(g)=0:    1.73561467137432e-06  *******             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #############</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Information related to the numerical optimization</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence code =  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Function eval. =  63 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gradian eval. =  NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> E[Y(0)] with 95% CI:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         0.025  0.975 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7278 0.6771 0.7786 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Causal risk ratio with 95% CI:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    CRR 0.025 0.975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X 1.14 1.013 1.283</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Multiple instrument example</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123456</span><span class="op">)</span></span>
<span class="r-in"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span class="r-in"><span class="va">psi0</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span class="r-in"><span class="va">G1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">2</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span class="r-in"><span class="va">G2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">2</span>, <span class="fl">0.3</span><span class="op">)</span></span>
<span class="r-in"><span class="va">G3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">2</span>, <span class="fl">0.4</span><span class="op">)</span></span>
<span class="r-in"><span class="va">U</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span class="r-in"><span class="va">pX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fl">0.7</span><span class="op">*</span><span class="va">G1</span> <span class="op">+</span> <span class="va">G2</span> <span class="op">-</span> <span class="va">G3</span> <span class="op">+</span> <span class="va">U</span><span class="op">)</span></span>
<span class="r-in"><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="va">pX</span><span class="op">)</span></span>
<span class="r-in"><span class="va">pY</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span> <span class="op">+</span> <span class="va">psi0</span><span class="op">*</span><span class="va">X</span> <span class="op">+</span> <span class="va">U</span><span class="op">)</span></span>
<span class="r-in"><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="va">pY</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">G1</span>, <span class="va">G2</span>, <span class="va">G3</span>, <span class="va">X</span>, <span class="va">Y</span><span class="op">)</span></span>
<span class="r-in"><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">msmm</span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span> <span class="op">|</span> <span class="va">G1</span> <span class="op">+</span> <span class="va">G2</span> <span class="op">+</span> <span class="va">G3</span>, data <span class="op">=</span> <span class="va">dat2</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation method: gmm </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GMM fit summary:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gmm::gmm(g = msmmMoments, x = dat, t0 = t0, vcov = "iid")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Method:  twoStep </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Estimate    Std. Error  t value     Pr(&gt;|t|)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Theta[1]  0.18250038  0.05196181  3.51220233  0.00044441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Theta[2]  0.45163610  0.41838256  1.07948119  0.28037327</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> J-Test: degrees of freedom is 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 J-test   P-value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test E(g)=0:    0.27121  0.87319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Initial values of the coefficients</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Theta[1]  Theta[2] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1831035 0.4392681 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> #############</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Information related to the numerical optimization</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence code =  0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Function eval. =  59 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gradian eval. =  NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> E[Y(0)] with 95% CI:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           0.025   0.975 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.18250 0.08066 0.28434 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Causal risk ratio with 95% CI:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     CRR  0.025 0.975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X 1.571 0.6919 3.567</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Tom Palmer, Wes Spiller, Eleanor Sanderson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer></div>

  

  

  </body></html>

